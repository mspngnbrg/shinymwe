---
title: "Start/publish apps on shiny.io"
output: html_notebook
---

```{r}

# 1. to be on the safe side, delete .httr-oauth file in 00_setup_readme folder
drop_auth_file <- ".httr-oauth"
if(file.exists(drop_auth_file ))file.remove(drop_auth_file )

# create your own dropbox token if needed (only once)
# ===================================================
library(rdrop2)
drop_auth() # opens website for dropbox PW 

# copy .httr-auth into all app folders
folder_names <- c("../01_collect_questions", "../02_question_curation", 
                  "../03_start_quiz", "../04_show_results")

for(INDEX in 1:length(folder_names)) {
  file.copy(list.files(getwd(), ".httr-oauth", all.files = TRUE), 
            folder_names[INDEX], overwrite = TRUE)
}

# DROPBOX vs locally? & folder names
# define input and output folders for the whole project 
# and copy this file into each app folder 
# =====================================================
d <- data.frame(questions_raw = "05_questions_1",
                questions_teacher = "05_teacher_1",
                answers_raw = "05_answers_1",
                dropbox = FALSE)
saveRDS(d, "folder_names.rds")

for(INDEX in 1:length(folder_names)) {
  temp_folder_name <- paste0(folder_names[INDEX], "/data")
  if(!dir.exists(temp_folder_name)) dir.create(temp_folder_name)
file.copy(list.files(getwd(), "folder_names.rds", all.files = TRUE), temp_folder_name , overwrite = TRUE) 
}

# start one app from this script by removing "#" (or select all text after "#" and hit "Enter") 

# rsconnect::deployApp('../01_collect_questions/', account = "mspangenberg")
# rsconnect::deployApp('../02_question_curation/', account = "mspangenberg")
# rsconnect::deployApp('../03_start_quiz/', account = "mspangenberg")
# rsconnect::deployApp('../04_show_results/', account = "mspangenberg")

# IF APPS WERE DELETED ON SHINYAPPS.IO MANUALLY:

#Preparing to deploy application...Error: HTTP 404
#GET https://api.shinyapps.io/v1/applications/5962207
#Not Found

# rsconnect::forgetDeployment("../01_collect_questions")
# rsconnect::forgetDeployment("../02_question_curation")
# rsconnect::forgetDeployment("../03_start_quiz")
# rsconnect::forgetDeployment("../04_show_results")
```

